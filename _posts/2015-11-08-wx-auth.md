---
layout : post
title : "微信服务号网页授权获取用户基本信息Java"
category : "微信"
tags : [微信,java]
published: false
---

# 需求

在做一个小的微信内网页应用时，需要收集微信用户的信息。

所以就查看了微信公众平台的开发者文档，并查找了一些资料，整理出下面的文档。

需要注意的是，订阅号没有`网页授权获取用户基本信息`这项功能。只有服务号才有，并且服务号需要通过微信认证。

# 配置

首先需要登陆微信的公众平台，在开发者中心找到`网页授权获取用户基本信息`这个接口，点击修改，修改`授权回调页面域名`。

这个地方只能是域名，并且不带`http://`。不支持IP地址，并且域名需要通过备案。

OK，如果配置好了，就可以进行下一步的开发了。

# 思路

1，当用户第一次进入我们系统的时候，我们并没有获得用户的授权，需要将用户重定向到微信的授权连接，然后通过微信的回调，回调到我们的服务上。

使用Interceptor进行拦截，如果用户在session中不存在，就需要重定向到微信的授权连接

2，当用户同意授权后，微信会回调到我们的URL上，并携带code参数

3，根据是否携带code，我们可以判断用户是否有授权。在用户授权后，使用微信提供的api获取用户信息


参考连接<http://mp.weixin.qq.com/wiki/17/c0f37d5704f0b64713d5d2c37b468d75.html>
